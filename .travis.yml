dist: xenial
os: linux
env:
  - XDEBUG_MODE="coverage"
language: php
php:
  - '7.4.15'
before_script:
  - mkdir -p /home/travis/build/drosanda/apptanya/app/cache/
  - chmod 775 /home/travis/build/drosanda/apptanya/app/cache/
  - sudo mysql -e 'CREATE DATABASE IF NOT EXISTS apptanya_db;'
  - sudo mysql -u root --default-character-set=utf8 apptanya_db < sql/apptanya_db.sql
  - sudo mysql -e 'SHOW DATABASES;'
  - sudo mysql -u root 'SHOW DATABASES;'
after_success:
    - bash <(curl -s https://codecov.io/bash)
    # - sonar-scanner
script:
  # the following command line builds the project, runs the tests with coverage and then execute the SonarCloud analysis
  - phpunit --configuration phpunit.xml --coverage-clover coverage.xml --log-junit junit.xml --testsuite Dev
addons:
  mariadb: '10.3'
